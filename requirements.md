# NitroRelay 要件定義書（v0.1）

## 1. 目的・背景
- 飲み会やパーティーで1台のスマホを回しながら遊ぶ「爆弾リレー」ゲームを提供する。
- スマホの揺れを CoreMotion で検知し、閾値を超えると爆発演出でゲームオーバー。緊張感と盛り上がりを演出する。

## 2. ターゲットユーザー・利用シーン
- 友人同士の飲み会・宅飲み・カジュアルな集まり。
- 1〜10人程度が1台のiPhoneを手渡ししながら遊ぶ。

## 3. 対応プラットフォーム
- iOS 16.0 以降（iPhone中心）。  
- 画面縦向き固定。

## 4. 機能要件
### 4.1 ゲームフロー
- 装填フェーズ：スマホを水平に静止させると自動で「装填完了」。静止判定は userAcceleration を用い、約1秒の静止を検出。
- リレー中フェーズ：揺れに応じて「カリカリ」音とバイブの強度・テンポが変化。カウントリズム（3→2→1→ピ）を常時再生。
- 爆発フェーズ：閾値超過で爆発演出（赤フラッシュ＋SE＋最大バイブ）を表示。
- 再スタート：爆発後に再装填できる。

### 4.2 揺れ判定・難易度
- CoreMotion の `userAcceleration` を0.02s間隔で取得し、合成加速度を計算。
- 簡易ローパスフィルタでスパイクを平滑化。
- 難易度プリセット（閾値）  
  - 激甘: 0.70G  
  - 普通: 0.52G  
  - 激辛: 0.26G  
- スパイス「感度ブースト」発動中は閾値が 1/2（感度200%）。

### 4.3 スパイス機能（任意ON/OFF）
- フェイント振動：ランダムで軽いバイブを発生。
- 指示カード（激辛時のみ）：右手だけ・利き手禁止・肘ピン・親指離せ・目を閉じる・肘はテーブルにつける・片手テーブルなどの持ち方指示を大きく表示。
- 感度ブースト：一定時間感度200%。

### 4.4 UI/UX
- メイン画面：タイトル、ステータスバッジ、揺れゲージ、現在G値、メッセージ、難易度ボタン、スタート/リセット、交代カウントスライダー、スパイストグル、バナー枠。
- ガイドシート：初回/随時に遊び方を表示。
- ダークテーマ前提。カラーパレットは赤〜オレンジ系。

### 4.5 広告・課金
- AdMob バナー（画面下）とインタースティシャル（爆発後）を表示。テストID／本番ID切替可能。
- 広告OFFボタン（買い切り想定）。現在はプレースホルダーで Apple アカウントページを開き、アプリ内フラグで非表示にする。

### 4.6 設定
- スパイス ON/OFF トグル（フェイント振動、指示カード）。
- 難易度選択（激甘/普通/激辛）。
- 交代カウント秒数スライダー（2〜10秒）。

## 5. 非機能要件
- パフォーマンス：0.02s間隔でのセンサー更新でも UI がスムーズに動くこと。
- バッテリー：長時間のバイブ連続使用を避ける設計（演出は短時間）。
- プライバシー：トラッキングは広告SDKに依存。App Tracking Transparency 対応を想定。

## 6. マネタイズ方針
- 無料＋広告（バナー＋爆発後のインタースティシャル）。
- 広告OFFの買い切り（ストア課金を将来実装）。価格目安 ¥300。

## 7. ビルド・配布
- バンドルID: `com.example.NitroRelay`
- バージョン: 1.0 / ビルド: 1
- 最低OS: iOS 16.0
- App Icon: Assets.xcassets/AppIcon に設定済み（差し替え可）。

## 8. 外部リンク
- サポートURL（App Store Connect 用想定）
  - 例: `https://your-domain.example.com/nitrorelay/support`
  - 内容: `support_page.md` を元に作成したサポート・FAQページ
- マーケティングURL
  - 例: `https://your-domain.example.com/nitrorelay`
  - 内容: `marketing_page.md` を元に作成した紹介・ランディングページ

## 9. 今後のTODO（リリース前に検討）
- AdMob SDK を本接続し、StoreKit の広告OFF課金を実装。
- App Privacy 回答、ATTダイアログ、プライバシーポリシーURL整備。
- 小サイズ用の簡略アイコンでぼやけ対策。
- 実機テスト：複数デバイスで爆発判定・広告表示・バックグラウンド復帰を確認。
